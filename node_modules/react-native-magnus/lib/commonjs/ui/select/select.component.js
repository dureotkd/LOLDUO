"use strict";var _interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault");var _interopRequireWildcard=require("@babel/runtime/helpers/interopRequireWildcard");Object.defineProperty(exports,"__esModule",{value:true});exports.Select=void 0;var _extends2=_interopRequireDefault(require("@babel/runtime/helpers/extends"));var _slicedToArray2=_interopRequireDefault(require("@babel/runtime/helpers/slicedToArray"));var React=_interopRequireWildcard(require("react"));var _reactNativeModal=_interopRequireDefault(require("react-native-modal"));var _reactNative=require("react-native");var _select=require("./select.style");var _div=require("../div/div.component");var _theme=require("../../theme");var _text=require("../text/text.component");var _input=require("../input/input.component");var _icon=require("../icon/icon.component");var _selectOption=require("./select.option.component");var _button=require("../button/button.component");var _useDefaultProps=require("../../utilities/useDefaultProps");var _jsxFileName="D:\\code\\react-native-magnus\\src\\ui\\select\\select.component.tsx";var Select=React.forwardRef(function(incomingProps,ref){var props=(0,_useDefaultProps.useDefaultProps)('Select',incomingProps,{bg:'white',rounded:'none',flexDir:'column',isVisible:false,renderNoResultsView:function renderNoResultsView(searchTerm){return React.createElement(_div.Div,{flex:1,px:"2xl",py:"xl",__source:{fileName:_jsxFileName,lineNumber:27,columnNumber:9}},React.createElement(_text.Text,{fontSize:"lg",__source:{fileName:_jsxFileName,lineNumber:28,columnNumber:11}},"No results found for \"",searchTerm,"\""));},keyExtractor:function keyExtractor(_,index){return"".concat(index);}});var value=props.value,title=props.title,message=props.message,footer=props.footer,data=props.data,multiple=props.multiple,_renderItem=props.renderItem,keyExtractor=props.keyExtractor,renderNoResultsView=props.renderNoResultsView,renderSubmitButton=props.renderSubmitButton,renderSearchInput=props.renderSearchInput,searchableProps=props.searchableProps,onSelectProp=props.onSelect;var _useTheme=(0,_theme.useTheme)(),theme=_useTheme.theme;var _useState=(0,React.useState)(props.isVisible||false),_useState2=(0,_slicedToArray2.default)(_useState,2),visible=_useState2[0],setVisible=_useState2[1];var _useState3=(0,React.useState)(value),_useState4=(0,_slicedToArray2.default)(_useState3,2),selectedValue=_useState4[0],setSelectedValue=_useState4[1];var _useState5=(0,React.useState)(''),_useState6=(0,_slicedToArray2.default)(_useState5,2),searchTerm=_useState6[0],setSearchTerm=_useState6[1];var isSearchable=(0,React.useMemo)(function(){return!!(searchableProps!==null&&searchableProps!==void 0&&searchableProps.length);},[searchableProps]);var computedStyle=(0,_select.getStyle)(theme,props);var resolveMultiLevelAccess=function resolveMultiLevelAccess(obj,key){return key.split('.').reduce(function(cur,keySection){if(cur===null||cur===undefined){return;}if(cur[keySection]===null||cur[keySection]===undefined){console.warn("Property \"".concat(key,"\" does not exists! "));return;}return cur[keySection];},obj);};var filteredData=(0,React.useMemo)(function(){if(!searchableProps||Array.isArray(searchableProps)&&!searchableProps.length){return data;}return data.filter(function(item){var lowSearch=searchTerm.toLowerCase();if(!Array.isArray(searchableProps)){return String(item).toLowerCase().includes(lowSearch);}return searchableProps.some(function(key){return String(resolveMultiLevelAccess(item,key)).toLowerCase().includes(lowSearch);});});},[searchableProps,searchTerm,data]);(0,React.useEffect)(function(){if('isVisible'in props){setVisible(props.isVisible||visible);}},[props,visible]);(0,React.useEffect)(function(){if(visible){clearSearchInput();}},[visible]);(0,React.useImperativeHandle)(ref,function(){return{close:function close(){setVisible(false);},open:function open(){setVisible(true);}};});var onSelect=function onSelect(value){var finalValue;if(multiple){var copy=selectedValue.slice();var index=selectedValue.indexOf(value);if(index!==-1){copy.splice(index,1);}else{copy.push(value);}setSelectedValue(copy);finalValue=copy;}else{setSelectedValue(value);setVisible(false);finalValue=value;}onSelectProp(finalValue);};var renderTitle=function renderTitle(){if(title){return typeof title==='string'?React.createElement(_text.Text,{px:"xl",fontSize:"lg",fontWeight:"bold",textTransform:"uppercase",__source:{fileName:_jsxFileName,lineNumber:156,columnNumber:11}},title):title;}return false;};var renderMessage=function renderMessage(){if(message){return typeof message==='string'?React.createElement(_text.Text,{px:"xl",fontSize:"lg",__source:{fileName:_jsxFileName,lineNumber:178,columnNumber:11}},message):message;}return false;};var clearSearchInput=function clearSearchInput(){return setSearchTerm('');};var renderSearchbar=function renderSearchbar(){if(!isSearchable){return;}var searchInputElement=renderSearchInput&&renderSearchInput({clearText:clearSearchInput});var mandatoryProps={value:searchTerm,onChangeText:function onChangeText(text){return setSearchTerm(text);},autoCompleteType:'off'};if(searchInputElement){return React.cloneElement(searchInputElement,mandatoryProps);}return React.createElement(_input.Input,(0,_extends2.default)({mx:"xl",mt:"-md",fontSize:"lg",placeholder:"Search items",bg:"gray200",prefix:React.createElement(_icon.Icon,{mr:"lg",name:"search1",color:"gray700",fontSize:"3xl",__source:{fileName:_jsxFileName,lineNumber:220,columnNumber:13}}),suffix:searchTerm?React.createElement(_button.Button,{mx:"-md",p:"md",alignSelf:"center",rounded:"circle",bg:"gray400",onPress:clearSearchInput,__source:{fileName:_jsxFileName,lineNumber:224,columnNumber:15}},React.createElement(_icon.Icon,{name:"close",fontSize:"xs",color:"gray900",__source:{fileName:_jsxFileName,lineNumber:232,columnNumber:17}})):null},mandatoryProps,{__source:{fileName:_jsxFileName,lineNumber:213,columnNumber:9}}));};var renderFooter=function renderFooter(){if(footer){return footer;}if(!multiple){return;}var submitButtonElement=renderSubmitButton&&renderSubmitButton();var mandatoryProps={onPress:function onPress(){return setVisible(false);}};if(submitButtonElement){return React.cloneElement(submitButtonElement,mandatoryProps);}return React.createElement(_button.Button,(0,_extends2.default)({block:true,rounded:"none",bg:"green600"},mandatoryProps,{__source:{fileName:_jsxFileName,lineNumber:263,columnNumber:9}}),React.createElement(_text.Text,{fontSize:"xl",py:"xs",color:"white",__source:{fileName:_jsxFileName,lineNumber:264,columnNumber:11}},"Submit"));};var renderNoResultsFound=function renderNoResultsFound(){renderNoResultsView&&renderNoResultsView(searchTerm);};return React.createElement(_reactNativeModal.default,{backdropTransitionOutTiming:0,animationIn:"slideInUp",isVisible:visible,backdropColor:"black",onBackdropPress:function onBackdropPress(){return setVisible(false);},onBackButtonPress:function onBackButtonPress(){return setVisible(false);},hideModalContentWhileAnimating:true,style:{margin:0,justifyContent:'flex-end'},__source:{fileName:_jsxFileName,lineNumber:276,columnNumber:7}},React.createElement(_div.Div,{style:computedStyle.wrapper,__source:{fileName:_jsxFileName,lineNumber:289,columnNumber:9}},React.createElement(_reactNative.SafeAreaView,{style:computedStyle.container,__source:{fileName:_jsxFileName,lineNumber:290,columnNumber:11}},React.createElement(_div.Div,{__source:{fileName:_jsxFileName,lineNumber:291,columnNumber:13}},React.createElement(_div.Div,{py:"xl",__source:{fileName:_jsxFileName,lineNumber:292,columnNumber:15}},renderTitle(),renderMessage()),React.createElement(_div.Div,{__source:{fileName:_jsxFileName,lineNumber:296,columnNumber:15}},renderSearchbar())),filteredData.length>0?React.createElement(_div.Div,{flex:1,__source:{fileName:_jsxFileName,lineNumber:300,columnNumber:15}},React.createElement(_reactNative.FlatList,{data:filteredData,keyExtractor:keyExtractor,renderItem:function renderItem(_ref){var item=_ref.item,index=_ref.index;return React.cloneElement(_renderItem(item,index),{onSelect:onSelect,selectedValue:selectedValue});},__source:{fileName:_jsxFileName,lineNumber:301,columnNumber:17}})):renderNoResultsFound(),renderFooter())));});exports.Select=Select;Select.Option=_selectOption.SelectOption;
//# sourceMappingURL=select.component.js.map