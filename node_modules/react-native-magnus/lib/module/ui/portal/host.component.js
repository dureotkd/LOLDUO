var _interopRequireWildcard=require("@babel/runtime/helpers/interopRequireWildcard");Object.defineProperty(exports,"__esModule",{value:true});exports.Host=exports.Context=void 0;var React=_interopRequireWildcard(require("react"));var _reactNative=require("react-native");var _useKey2=require("./hooks/useKey");var _manager=require("./manager.component");var _jsxFileName="D:\\code\\react-native-magnus\\src\\ui\\portal\\host.component.tsx";var Context=React.createContext(null);exports.Context=Context;var Host=function Host(_ref){var children=_ref.children,style=_ref.style;var managerRef=React.useRef(null);var queue=[];var _useKey=(0,_useKey2.useKey)(),generateKey=_useKey.generateKey,removeKey=_useKey.removeKey;React.useEffect(function(){var _managerRef$current,_managerRef$current2,_managerRef$current3;while(queue.length&&managerRef.current){var action=queue.pop();if(action){switch(action.type){case'mount':(_managerRef$current=managerRef.current)===null||_managerRef$current===void 0?void 0:_managerRef$current.mount(action.key,action.children);break;case'update':(_managerRef$current2=managerRef.current)===null||_managerRef$current2===void 0?void 0:_managerRef$current2.update(action.key,action.children);break;case'unmount':(_managerRef$current3=managerRef.current)===null||_managerRef$current3===void 0?void 0:_managerRef$current3.unmount(action.key);break;}}}},[]);var mount=function mount(children){var key=generateKey();if(managerRef.current){managerRef.current.mount(key,children);}else{queue.push({type:'mount',key:key,children:children});}return key;};var update=function update(key,children){if(managerRef.current){managerRef.current.update(key,children);}else{var op={type:'mount',key:key,children:children};var index=queue.findIndex(function(o){return o.type==='mount'||o.type==='update'&&o.key===key;});if(index>-1){queue[index]=op;}else{queue.push(op);}}};var unmount=function unmount(key){if(managerRef.current){managerRef.current.unmount(key);removeKey(key);}else{queue.push({type:'unmount',key:key});}};return React.createElement(Context.Provider,{value:{mount:mount,update:update,unmount:unmount},__source:{fileName:_jsxFileName,lineNumber:88,columnNumber:5}},React.createElement(_reactNative.View,{style:[{flex:1},style],collapsable:false,pointerEvents:"box-none",__source:{fileName:_jsxFileName,lineNumber:89,columnNumber:7}},children),React.createElement(_manager.Manager,{ref:managerRef,__source:{fileName:_jsxFileName,lineNumber:97,columnNumber:7}}));};exports.Host=Host;
//# sourceMappingURL=host.component.js.map